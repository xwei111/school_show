"use strict";(self["webpackChunkschool"]=self["webpackChunkschool"]||[]).push([[571],{1571:function(e,l,a){a.r(l),a.d(l,{default:function(){return w}});var o=a(3396),d=a(7139);function t(e,l,a,t,u,r){const s=(0,o.up)("el-table-column"),n=(0,o.up)("el-link"),i=(0,o.up)("el-table"),c=(0,o.up)("Modal");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(i,{data:t.dataSource,style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{prop:"roleName",label:"角色名称"}),(0,o.Wm)(s,{prop:"gmtCreate",label:"创建时间"}),(0,o.Wm)(s,{prop:"roleDesc",label:"角色描述"}),(0,o.Wm)(s,{prop:"roleStatus",label:"角色状态"},{default:(0,o.w5)((({row:e})=>[(0,o._)("div",null,(0,d.zw)(1===e.roleStatus?"启用":0===e.roleStatus?"禁用":"- -"),1)])),_:1}),(0,o.Wm)(s,{prop:"oprate",label:"操作"},{default:(0,o.w5)((({row:e})=>[(0,o._)("div",null,[(0,o.Wm)(n,{style:{"margin-right":"10px"},type:"primary",onClick:l=>t.editHandle(e)},{default:(0,o.w5)((()=>[(0,o.Uk)("编辑")])),_:2},1032,["onClick"]),(0,o.Wm)(n,{type:"primary",onClick:l=>t.deleteHandle(e)},{default:(0,o.w5)((()=>[(0,o.Uk)("删除")])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"]),(0,o.Wm)(c,{detail:t.detail,visible:t.visible,onHandleClose:t.handleClose,onSuccessHandle:t.successHandle},null,8,["detail","visible","onHandleClose","onSuccessHandle"])])}var u=a(4870),r=a(5804);const s={class:"footer"};function n(e,l,a,d,t,u){const r=(0,o.up)("el-input"),n=(0,o.up)("el-form-item"),i=(0,o.up)("el-switch"),c=(0,o.up)("el-tree"),m=(0,o.up)("el-form"),p=(0,o.up)("el-button"),f=(0,o.up)("el-dialog");return(0,o.wg)(),(0,o.j4)(f,{title:"添加角色",modelValue:d.dialogVisible,"onUpdate:modelValue":l[3]||(l[3]=e=>d.dialogVisible=e),width:"30%","before-close":d.handleClose},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{ref:"formRef",model:d.form,rules:d.rules,style:{width:"100%"},"label-position":"top"},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{label:"角色名称",prop:"roleName"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{modelValue:d.form.roleName,"onUpdate:modelValue":l[0]||(l[0]=e=>d.form.roleName=e),clearable:"",placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(n,{style:{"margin-bottom":"30px"},label:"角色描述",prop:"roleDesc"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{modelValue:d.form.roleDesc,"onUpdate:modelValue":l[1]||(l[1]=e=>d.form.roleDesc=e),clearable:"",placeholder:"请输入角色描述"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(n,{prop:"roleStatus"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{modelValue:d.form.roleStatus,"onUpdate:modelValue":l[2]||(l[2]=e=>d.form.roleStatus=e),"inactive-text":"角色状态","active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),(0,o.Wm)(n,{label:"权限",prop:"menuIds"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{ref:"treeRef",data:d.data,props:{children:"children",label:"label"},"show-checkbox":"","node-key":"id","default-expand-all":"",onCheck:d.handleCheckChange},null,8,["data","onCheck"])])),_:1})])),_:1},8,["model","rules"]),(0,o._)("div",s,[(0,o.Wm)(p,{onClick:d.handleClose},{default:(0,o.w5)((()=>[(0,o.Uk)("取消")])),_:1},8,["onClick"]),(0,o.Wm)(p,{type:"primary",onClick:d.addHandle},{default:(0,o.w5)((()=>[(0,o.Uk)("保存")])),_:1},8,["onClick"])])])),_:1},8,["modelValue","before-close"])}var i=a(7178);const c={roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"}],menuIds:[{required:!0,message:"请选择权限",trigger:"blur"}]},m=[{id:"1",label:"系统管理",children:[{id:"11",label:"菜单管理"},{id:"12",label:"角色管理"},{id:"13",label:"用户管理"},{id:"14",label:"登陆日志"}]},{id:"2",label:"评分管理",children:[{id:"21",label:"新增评分任务"},{id:"22",label:"查看评分列表"}]}];var p={props:{visible:Boolean,detail:Object},setup(e,{emit:l}){const{updateRole:a}=r["default"],d=(0,u.iH)(),t=(0,u.iH)(),s=(0,u.iH)(!1),n=(0,u.qj)({roleName:"",roleDesc:"",roleStatus:!0,menuIds:null}),p=()=>{d.value&&d.value.resetFields(),t.value&&t.value.setCheckedKeys([]),l("handleClose")},f=(e,{checkedKeys:l})=>{n.menuIds=l},b=()=>{d.value&&d.value.validate((o=>{if(o){const{id:o}=e.detail;a({...n,id:o}).then((e=>{e?.success&&(i.z8.success("保存成功"),l("successHandle"),p())}))}}))};return(0,o.YP)((()=>e.visible),(l=>{if(s.value=l,l){const{roleName:l,roleDesc:a,roleStatus:o,menuIds:d}=e.detail??{};n.roleName=l,n.roleDesc=a,n.roleStatus=o,n.menuIds=d}})),{form:n,formRef:d,treeRef:t,rules:c,data:m,dialogVisible:s,addHandle:b,handleClose:p,handleCheckChange:f}}},f=a(89);const b=(0,f.Z)(p,[["render",n],["__scopeId","data-v-0df9d5a8"]]);var v=b;const h=[{label:"全部",value:"1"},{label:"启用",value:"2"},{label:"禁用",value:"3"}];var C={components:{Modal:v},setup(){const{getRioleList:e,deleteRole:l}=r["default"],a=(0,u.iH)(!1),o=(0,u.iH)(null),d=(0,u.qj)({name:"",status:"1"}),t=(0,u.iH)([]),s=()=>{e().then((e=>{t.value=e?.data??[]}))};s();const n=()=>{o.value=null,a.value=!0},c=e=>{a.value=!0,o.value=e},m=e=>{l({id:e?.id}).then((e=>{e?.success&&(i.z8.success("删除成功"),s())}))},p=()=>{a.value=!1},f=()=>s();return{form:d,detail:o,visible:a,options:h,dataSource:t,addHandle:n,editHandle:c,deleteHandle:m,handleClose:p,successHandle:f}}};const k=(0,f.Z)(C,[["render",t],["__scopeId","data-v-72ac9dd6"]]);var w=k}}]);
//# sourceMappingURL=571.61f046b7.js.map